<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Posts</title>
    <!-- Bootstrap Core CSS -->
    <link href="/myapp/css/bootstrap.min.css" rel="stylesheet">
    <link href="/myapp/css/agency.css" rel="stylesheet">
    <link href="/myapp/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">    
    <link href='http://fonts.googleapis.com/css?family=Quattrocento|Codystar:300,400|Kaushan+Script' rel='stylesheet'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
</head>

<body id="page-top" class="index">
<script>
var pageAccessToken;
var pageId = '741456956032836';
// This is called with the results from from FB.getLoginStatus().
  function statusChangeCallback(response) {
    if (response.status === 'connected') {
       getPageAccessToken();
       updateName();
    } else {
          FB.login(function(response) {
         // handle the response
        }, {scope: 'publish_pages,user_likes, manage_pages, publish_actions, read_insights, pages_show_list'});
    }
  }

    function updateName(){
      FB.api('me','get', function(response){
          $("#fb-name").html(', ' + response.name);
      });
    }

// This function is called when someone finishes with the Login
  // Button.  See the onlogin handler attached to it in the sample
  // code below.
  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  }

//start of fb init
window.fbAsyncInit = function() {
    FB.init({
      appId      : '186309531858497',
      xfbml      : true,
      version    : 'v2.8'
    });
    FB.AppEvents.logPageView();
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));

  //end of fb init

  function postToPage() {
    FB.api('/'+pageId+'/feed', 'post', 
         { 
             message     : "It's published ...",
             //link        : 'http://csslight.com',
             //picture     : 'http://csslight.com/application/upload/WebsitePhoto/567-grafmiville.png',

             access_token: pageAccessToken,
             name        : 'name',
             from        : 'pageid',
             description : 'testing some dscription.',
           }, 
           function(response) {
               console.log(JSON.stringify(response));
           });
  }

  function getPageAccessToken(){
    FB.api('/' + pageId + '?fields=access_token', 'get', function(response){
        pageAccessToken = response.access_token;
        console.log(response.access_token);
    });
  }

function getUnpublishedPost(){
  FB.api('/'+ pageId +'/promotable_posts?is_published=false', 'get', function(response){
    console.log(JSON.stringify(response));
  });
}

function getPublishedPosts(){
  FB.api('/'+ pageId +'/posts', 'get', function(response){
    console.log(JSON.stringify(response));
  });
}

 function postUnpublished(){
       FB.api('/' + pageId + '/feed', 'post', 
         { 
             message     : "It's unpublished ...",
             //link        : 'http://csslight.com',
             //picture     : 'http://csslight.com/application/upload/WebsitePhoto/567-grafmiville.png',

             access_token: pageAccessToken,
             name        : 'name',
             from        : 'pageid',
             description : 'testing some dscription.',
             published    : false
           }, 
           function(response) {
               console.log(JSON.stringify(response));
           });
 }

 function getPageViewerNumber(){
      FB.api('741456956032836/insights?metric=page_views_total&period=week&since=1488368656&access_token=' + pageAccessToken, 
        function (response) {
          if (response && !response.error) {
            console.log(response.data);
            console.log(response);
          }
        }
    );
 }

  function getPostViewerNumber(){
      FB.api('741456956032836_742048119307053/insights/post_impressions_unique?access_token=' + pageAccessToken, 'get',
        function (response) {
          if (response && !response.error) {
            console.log(response.data);
            console.log(response);
          }
          else{
             console.log(JSON.stringify(response));
          }
        }
    );
 }

</script>


 <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand page-scroll" href="#page-top">Q & J's Wedding</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="hidden">
                    <a href="#page-top"></a>
                </li>
                <li>
                    <a class="page-scroll" href="#posts">Say Congrats</a>
                </li>
                <li>
                    <a class="page-scroll" href="#view-posts">View Other Posts</a>
                </li>
            </ul>
        </div>
      
    </div>
 </nav>


 <header class="bg-tiffany header-height-400">
      <div class="container" id="header-container" style="position: relative;"> 
            <div class="header-content">
             <div class="intro-text">
                  <div class="intro-lead-in">Hello<span id='fb-name'></span></div>
             </div>

              <div id="login">
                  <p>Not you?</p>
                  <div class="fb-login-button page-scroll" data-max-rows="1" data-size="large" data-show-faces="false" data-auto-logout-link="true"></div> 
              </div>
            </div>
      </div> 
  </header>
 
 <section id="posts" class="grad-section-bottom">
         <div class="row">
            <div class="col-lg-12 text-center">
                <h2 class="section-heading">Share Your Congrats</h2>
                <h3 class="section-subheading text-muted">post on facebook page</h3>
            </div>
          </div>
         <div class="row">
            <input type="text-area">
         </div>
 </section>

 <section id="view-posts" class="bg-light-tiffany">
        <div class="row">
            <div class="col-lg-12 text-center">
                <h2 class="section-heading">View Others Posts</h2>
                <h3 class="section-subheading text-muted">view posts from facebook page</h3>
            </div>
          </div>
 </section>


 <div id="post" class="container-fluid">
  <row>
    <div class="col-md-1">
      <form>
        <label for="post">Post</label>
         <input type="text" class="form-control" id="post">
         <button type="button" class="btn btn-default" onClick="getPageAccessToken()">getPagetoken</button>
         <button type="button" class="btn btn-default" onClick="postToPage()">post</button>
         <button type="button" class="btn btn-default" onClick="postUnpublished()">postUnpublished</button>
         <button type="button" class="btn btn-default" onClick="getUnpublishedPost()">getUnpublished</button>
         <button type="button" class="btn btn-default" onClick="getPublishedPosts()">getPublished</button>
         <button type="button" class="btn btn-default" onClick="getPageViewerNumber()">getPageViewNumber</button>
           <button type="button" class="btn btn-default" onClick="getPostViewerNumber()">getPostViewNumber</button>
      </form>
    </div>
  </row>
 </div>

 
<div id="fb-root"></div>


</div>
<footer class = "bg-light-gray">
        <div class="container ">
            <div class="row">
                <div class="col-md-4 col-md-offset-4">
                    <span class="copyright">Copyright &copy; Qile He & Jiajun Shen  2016</span>
                </div>
                <div class="col-md-4">
                    <ul class="list-inline quicklinks">
                        <li>
                            <span class="copyright">Graphic Resource: </span>
                            <a href="http://www.freepik.com">Designed by Freepik</a>
                        </li>
                    </ul>
                </div> 
            </div>
        </div>
    </footer>
</body>

</html>